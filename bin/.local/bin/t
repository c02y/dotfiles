#!/bin/bash

if ! hash tmux 2>/dev/null; then
	echo tmux is not installed, please install it!
	return 1
fi

if [ $(basename $SHELL) != "fish" ]; then
	if [ -f ~/anaconda3/bin/fish ]; then
		export SHELL=~/anaconda3/bin/fish
	elif hash fish 2>/dev/null; then
		export SHELL=$(which fish)
	else
		echo "No fish is installed, using old $SHELL as SHELL!"
	fi
fi

while getopts ":n" args; do
	case "$args" in
		\?)
			echo "t or t -n"
			exit
			;;
		n)
			tmux -2  # new
			exit
			;;
	esac
done

# attach a session if it exists, it failed, tmux a new one, if failed, echo message
tmux attach 2>/dev/null || tmux -2 2>/dev/null || echo "Already inside a tmux session!"
